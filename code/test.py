import numpy as np
import pandas as pd
import seqlogo
import matplotlib


matplotlib.use('Agg')  



from weblogo import LogoData, LogoOptions, LogoFormat, png_formatter
from weblogo.seq import unambiguous_protein_alphabet,reduced_nucleic_alphabet,reduced_protein_alphabet,protein_alphabet

# Step 1: Define your frequency matrix directly (no counts)
# Each row must sum to 1.0


for c in unambiguous_protein_alphabet:
    print (c)



frequency_matrix = np.array([
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.125, 0.0, 0.125, 0.125, 0.0, 0.0, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.0, 0.0],
    [0.125, 0.0, 0.125, 0.125, 0.0, 0.0, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.125, 0.875, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.875, 0.0, 0.0, 0.0, 0.0, 0.0]])
# Step 2: Create logo data directly from probabilities
logo_data = LogoData.from_counts(
    alphabet=unambiguous_protein_alphabet,
    counts=frequency_matrix
)

# Step 3: Set logo options
logo_options = LogoOptions()
logo_options.title = "Logo from Frequency Matrix (Probabilities)"

# Step 4: Format and export to PNG
logo_options = LogoOptions()
logo_options.title = "High-Res Logo"
logo_options.stack_width = 50   # increase width of each position
logo_options.stack_height = 100 # increase overall height

logo_format = LogoFormat(logo_data, logo_options)

# Save as higher-res PNG
with open("high_res_logo.png", "wb") as f:
    f.write(png_formatter(logo_data, logo_format))
'''
empty_matrix = np.matrix([[0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0], 
     [0,0,0,0,0,0,0,0,0,0]] )

columns=['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y',"X","*","-"]


Ps_m = [[('A', 0.0), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.027346637102734665), ('G', 0.010347376201034738), ('H', 0.0), ('I', 0.24833702882483372), ('K', 0.0), ('L', 0.6178861788617886), ('M', 0.032520325203252036), ('N', 0.0), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.0), ('T', 0.0), ('V', 0.06282335550628233), ('W', 0.0), ('Y', 0.0007390983000739098)], [('A', 0.8033998521803399), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.0), ('K', 0.0), ('L', 0.011825572801182557), ('M', 0.0), ('N', 0.0), ('P', 0.0), ('Q', 0.0), ('R', 0.0014781966001478197), ('S', 0.16112342941611235), ('T', 0.0), ('V', 0.022172949002217297), ('W', 0.0), ('Y', 0.0)], [('A', 0.14929785661492978), ('C', 0.0), ('D', 0.03695491500369549), ('E', 0.08499630450849963), ('F', 0.0022172949002217295), ('G', 0.021433850702143386), ('H', 0.11160384331116038), ('I', 0.028085735402808575), ('K', 0.07317073170731707), ('L', 0.04434589800443459), ('M', 0.03621581670362158), ('N', 0.058388765705838876), ('P', 0.0), ('Q', 0.08647450110864745), ('R', 0.1337767923133777), ('S', 0.06577974870657798), ('T', 0.026607538802660754), ('V', 0.03547671840354767), ('W', 0.0), ('Y', 0.005173688100517369)], [('A', 0.12342941611234294), ('C', 0.005912786400591279), ('D', 0.016260162601626018), ('E', 0.11012564671101256), ('F', 0.0022172949002217295), ('G', 0.005173688100517369), ('H', 0.004434589800443459), ('I', 0.03917220990391722), ('K', 0.13008130081300814), ('L', 0.059127864005912786), ('M', 0.04878048780487805), ('N', 0.026607538802660754), ('P', 0.0007390983000739098), ('Q', 0.0835181079083518), ('R', 0.07834441980783444), ('S', 0.17442719881744273), ('T', 0.059127864005912786), ('V', 0.014781966001478197), ('W', 0.014042867701404288), ('Y', 0.003695491500369549)], [('A', 0.003695491500369549), ('C', 0.017738359201773836), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.0679970436067997), ('K', 0.0), ('L', 0.6282335550628233), ('M', 0.0066518847006651885), ('N', 0.010347376201034738), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.004434589800443459), ('T', 0.20694752402069475), ('V', 0.05395417590539542), ('W', 0.0), ('Y', 0.0)], [('A', 0.011086474501108648), ('C', 0.08499630450849963), ('D', 0.06430155210643015), ('E', 0.028824833702882482), ('F', 0.0), ('G', 0.30303030303030304), ('H', 0.04212860310421286), ('I', 0.0), ('K', 0.057649667405764965), ('L', 0.014042867701404288), ('M', 0.005173688100517369), ('N', 0.24316334072431633), ('P', 0.0), ('Q', 0.0524759793052476), ('R', 0.020694752402069475), ('S', 0.06356245380635625), ('T', 0.0014781966001478197), ('V', 0.004434589800443459), ('W', 0.0), ('Y', 0.0029563932002956393)], [('A', 0.0), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.021433850702143386), ('K', 0.0), ('L', 0.8906134515890614), ('M', 0.06504065040650407), ('N', 0.0), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.0), ('T', 0.0), ('V', 0.022912047302291204), ('W', 0.0), ('Y', 0.0)], [('A', 0.007390983000739098), ('C', 0.0022172949002217295), ('D', 0.04582409460458241), ('E', 0.06430155210643015), ('F', 0.0), ('G', 0.0029563932002956393), ('H', 0.003695491500369549), ('I', 0.0), ('K', 0.03547671840354767), ('L', 0.0022172949002217295), ('M', 0.0), ('N', 0.05543237250554324), ('P', 0.07464892830746489), ('Q', 0.03695491500369549), ('R', 0.030303030303030304), ('S', 0.20029563932002956), ('T', 0.43532889874353287), ('V', 0.0029563932002956393), ('W', 0.0), ('Y', 0.0)], [('A', 0.012564671101256468), ('C', 0.0), ('D', 0.06873614190687362), ('E', 0.5417590539541759), ('F', 0.0007390983000739098), ('G', 0.0), ('H', 0.0), ('I', 0.0022172949002217295), ('K', 0.090169992609017), ('L', 0.04286770140428677), ('M', 0.019955654101995565), ('N', 0.005912786400591279), ('P', 0.10347376201034737), ('Q', 0.04434589800443459), ('R', 0.011086474501108648), ('S', 0.008869179600886918), ('T', 0.018477457501847747), ('V', 0.019955654101995565), ('W', 0.0), ('Y', 0.008869179600886918)], [('A', 0.09682187730968218), ('C', 0.003695491500369549), ('D', 0.032520325203252036), ('E', 0.05617147080561715), ('F', 0.0), ('G', 0.0022172949002217295), ('H', 0.0), ('I', 0.007390983000739098), ('K', 0.05469327420546933), ('L', 0.016260162601626018), ('M', 0.0014781966001478197), ('N', 0.020694752402069475), ('P', 0.004434589800443459), ('Q', 0.008869179600886918), ('R', 0.37767923133776793), ('S', 0.08425720620842572), ('T', 0.1958610495195861), ('V', 0.03621581670362158), ('W', 0.0), ('Y', 0.0007390983000739098)], [('A', 0.0029563932002956393), ('C', 0.0), ('D', 0.0007390983000739098), ('E', 0.003695491500369549), ('F', 0.0), ('G', 0.0), ('H', 0.0066518847006651885), ('I', 0.0), ('K', 0.013303769401330377), ('L', 0.0), ('M', 0.0), ('N', 0.0022172949002217295), ('P', 0.0), ('Q', 0.6762749445676275), ('R', 0.15077605321507762), ('S', 0.003695491500369549), ('T', 0.016260162601626018), ('V', 0.12342941611234294), ('W', 0.0), ('Y', 0.0)], [('A', 0.0), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.2845528455284553), ('K', 0.0), ('L', 0.011825572801182557), ('M', 0.0), ('N', 0.0), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.0), ('T', 0.0), ('V', 0.7036215816703622), ('W', 0.0), ('Y', 0.0)], [('A', 0.03547671840354767), ('C', 0.0), ('D', 0.0), ('E', 0.03547671840354767), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.010347376201034738), ('K', 0.5092387287509239), ('L', 0.0), ('M', 0.0), ('N', 0.03473762010347376), ('P', 0.0), ('Q', 0.18403547671840353), ('R', 0.09903917220990392), ('S', 0.058388765705838876), ('T', 0.022172949002217297), ('V', 0.0), ('W', 0.0), ('Y', 0.011086474501108648)], [('A', 0.0), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.016999260901699925), ('G', 0.0), ('H', 0.0), ('I', 0.43385070214338506), ('K', 0.0022172949002217295), ('L', 0.0014781966001478197), ('M', 0.0), ('N', 0.09386548410938655), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.0007390983000739098), ('T', 0.07612712490761271), ('V', 0.37472283813747226), ('W', 0.0), ('Y', 0.0)], [('A', 0.0), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.0), ('K', 0.0), ('L', 0.0), ('M', 0.0), ('N', 0.0), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.0), ('T', 0.0), ('V', 0.0), ('W', 1.0), ('Y', 0.0)], [('A', 0.0), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.9815225424981523), ('G', 0.0), ('H', 0.0), ('I', 0.0), ('K', 0.0), ('L', 0.0), ('M', 0.0), ('N', 0.0), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.0), ('T', 0.0), ('V', 0.003695491500369549), ('W', 0.0), ('Y', 0.014781966001478197)], [('A', 0.037694013303769404), ('C', 0.06504065040650407), ('D', 0.0), ('E', 0.0022172949002217295), ('F', 0.0), ('G', 0.011825572801182557), ('H', 0.0066518847006651885), ('I', 0.04582409460458241), ('K', 0.06651884700665188), ('L', 0.0), ('M', 0.0), ('N', 0.0007390983000739098), ('P', 0.0), ('Q', 0.7398373983739838), ('R', 0.0007390983000739098), ('S', 0.019955654101995565), ('T', 0.0029563932002956393), ('V', 0.0), ('W', 0.0), ('Y', 0.0)], [('A', 0.0), ('C', 0.0), ('D', 0.0007390983000739098), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.0007390983000739098), ('I', 0.0), ('K', 0.0), ('L', 0.0), ('M', 0.0), ('N', 0.9977827050997783), ('P', 0.0), ('Q', 0.0), ('R', 0.0), ('S', 0.0), ('T', 0.0007390983000739098), ('V', 0.0), ('W', 0.0), ('Y', 0.0)], [('A', 0.04434589800443459), ('C', 0.0029563932002956393), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.021433850702143386), ('I', 0.0), ('K', 0.07982261640798226), ('L', 0.0), ('M', 0.0), ('N', 0.004434589800443459), ('P', 0.0), ('Q', 0.06134515890613452), ('R', 0.7694013303769401), ('S', 0.0022172949002217295), ('T', 0.007390983000739098), ('V', 0.0007390983000739098), ('W', 0.0), ('Y', 0.005912786400591279)], [('A', 0.0007390983000739098), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0007390983000739098), ('H', 0.0), ('I', 0.0), ('K', 0.0014781966001478197), ('L', 0.0), ('M', 0.0), ('N', 0.0), ('P', 0.0), ('Q', 0.0), ('R', 0.9970436067997044), ('S', 0.0), ('T', 0.0), ('V', 0.0), ('W', 0.0), ('Y', 0.0)], [('A', 0.34146341463414637), ('C', 0.010347376201034738), ('D', 0.0), ('E', 0.0007390983000739098), ('F', 0.0007390983000739098), ('G', 0.0), ('H', 0.0007390983000739098), ('I', 0.014781966001478197), ('K', 0.04434589800443459), ('L', 0.0), ('M', 0.28898743532889876), ('N', 0.012564671101256468), ('P', 0.0), ('Q', 0.08130081300813008), ('R', 0.031781226903178125), ('S', 0.04360679970436068), ('T', 0.06577974870657798), ('V', 0.031042128603104215), ('W', 0.0014781966001478197), ('Y', 0.030303030303030304)], [('A', 0.0029563932002956393), ('C', 0.0), ('D', 0.0), ('E', 0.011086474501108648), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.0), ('K', 0.7694013303769401), ('L', 0.0), ('M', 0.0), ('N', 0.0), ('P', 0.0), ('Q', 0.016999260901699925), ('R', 0.19660014781966), ('S', 0.0022172949002217295), ('T', 0.0), ('V', 0.0007390983000739098), ('W', 0.0), ('Y', 0.0)], [('A', 0.03325942350332594), ('C', 0.029563932002956393), ('D', 0.037694013303769404), ('E', 0.12638580931263857), ('F', 0.04360679970436068), ('G', 0.008869179600886918), ('H', 0.05617147080561715), ('I', 0.031042128603104215), ('K', 0.011825572801182557), ('L', 0.08647450110864745), ('M', 0.05617147080561715), ('N', 0.014042867701404288), ('P', 0.0), ('Q', 0.05395417590539542), ('R', 0.0014781966001478197), ('S', 0.019955654101995565), ('T', 0.03399852180339985), ('V', 0.005173688100517369), ('W', 0.30524759793052475), ('Y', 0.0450849963045085)], [('A', 0.011086474501108648), ('C', 0.0), ('D', 0.0), ('E', 0.0), ('F', 0.0), ('G', 0.0), ('H', 0.0), ('I', 0.0029563932002956393), ('K', 0.6940133037694013), ('L', 0.0), ('M', 0.0022172949002217295), ('N', 0.0007390983000739098), ('P', 0.0), ('Q', 0.0), ('R', 0.24538063562453807), ('S', 0.0), ('T', 0.0), ('V', 0.0), ('W', 0.04360679970436068), ('Y', 0.0)]]
Ps_d = {}

count = 0
for list in Ps_m:
    for tuple in list:
        if count == 0:
            Ps_d[tuple[0]] = [tuple[1]]
        else:
            Ps_d[tuple[0]].append(tuple[1])
    count += 1

Ps = pd.DataFrame(Ps_d)
cpm = seqlogo.CompletePm(ppm = Ps,alphabet_type = 'AA')
print(cpm.ppm)
ppm = seqlogo.Ppm(Ps,alphabet_type = 'AA')
seqlogo.seqlogo(ppm, ic_scale = True, format = 'png',filename='logo.png', size = 'medium')



array = np.array([
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.125, 0.0, 0.125, 0.125, 0.0, 0.0, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.0, 0.0],
    [0.125, 0.0, 0.125, 0.125, 0.0, 0.0, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.125, 0.875, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.875, 0.0, 0.0, 0.0, 0.0, 0.0]])


df2 = pd.DataFrame(np.array([
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.125, 0.0, 0.125, 0.125, 0.0, 0.0, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.0, 0.0],
    [0.125, 0.0, 0.125, 0.125, 0.0, 0.0, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.125, 0.875, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.875, 0.0, 0.0, 0.0, 0.0, 0.0]
]),
                   columns=['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y'])


cpm = seqlogo.CompletePm(ppm = df2,alphabet_type = 'AA')
ppm = seqlogo.Ppm(df2,alphabet_type = 'AA')
seqlogo.seqlogo(ppm, ic_scale = True, format = 'png',filename='logo.png', size = 'large')


array_20 = np.array([
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.125, 0.125, 0.125, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0,  0.125, 0.125, 0.125, 0.125,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [ 0.875, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.125, 0.0],
    [0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5,],
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,  0.875, 0.0, 0.0, 0.0, 0.125, 0.0, 0.0]])

df_20 = pd.DataFrame(array_20, columns=['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y'])


cpm = seqlogo.CompletePm(ppm = df_20,alphabet_type = 'AA')
print(cpm.ppm)
ppm = seqlogo.Ppm(df_20,alphabet_type = 'AA')
seqlogo.seqlogo(ppm, ic_scale = True, format = 'png',filename='logo.png', size = 'medium')


'''

'''
logodata = LogoData.from_counts(counts=array,alphabet= 'AA')  # Convert counts to LogoData


logooptions = LogoOptions(
    unit_name='bits',   # Use bits for information content
    show_fineprint=False,
    show_ends=False
)
logooptions.title = "A Logo Title"
logoformat = LogoFormat(logodata, logooptions)
eps = eps_formatter(logodata, logoformat)
with open('dna_logo.eps', 'wb') as f:
    f.write(eps)


df2 = pd.DataFrame(np.array([
    [8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [1, 0.0, 1, 1, 0.0, 0.0, 0.0, 1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1, 1, 1, 1, 0.0, 0.0],
    [1, 0.0, 1, 1, 0.0, 0.0, 0.0, 1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1, 1, 1, 1, 0.0, 0.0],
    [4, 4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [4, 4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [1, 7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [4, 4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [4, 4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1, 7, 0.0, 0.0, 0.0, 0.0, 0.0]
]),
                   columns=['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y'])


cpm = seqlogo.CompletePm(pfm = df2,alphabet_type = 'AA')
ppm = seqlogo.Ppm(cpm.ppm,alphabet_type = 'AA')

print (cpm.pfm)
seqlogo.seqlogo(ppm, ic_scale = True, format = 'png',filename='logo.png', size = 'large')
'''


'''
leafs = ['a','b',"c",'d','e','f','g','h']
matrixs = {}
characters = ['A','C',"D","E","I","Q","R","S","T","V"]

seq_list = ['AAAAACAACQ','AARVACCCAR','AAVRACCACR','AAESACCCAR','AASECACACR','AATICACCAR','AAIDCACACR','AADTCACCAR']

count = 0
for seq in seq_list:
    seq_matrix = empty_matrix.copy()
    for i in range(0,10):
        character_index = characters.index(seq[i])
        seq_matrix[character_index,i] = 1
    matrixs[leafs[count]] = seq_matrix
    count += 1

v_1 = 0.1
v_2 = 0.1
v_9_p= 0.1 + 0.01/0.2
v_10_p= 0.1 + 0.01/0.2
v_11_p= 0.1 + 0.01/0.2
v_12_p = 0.1 + 0.01/0.2
v_13_p= 0.1+ (v_9_p*v_9_p)/ (v_9_p*2)
v_14_p = 0.1+ (v_9_p*v_9_p)/ (v_9_p*2)

x_9 = (v_1*matrixs["b"] + v_2 * matrixs['a']) / (v_1+v_2)
x_10 = (v_1*matrixs['d'] + v_2 * matrixs["c"]) / (v_1+v_2)
x_11 = (v_1*matrixs["f"] + v_2 * matrixs["e"]) / (v_1+v_2)
x_12 = (v_1*matrixs["h"] + v_2 * matrixs["g"]) / (v_1+v_2)

x_13 = (v_9_p*x_10 + v_10_p * x_9) / (v_9_p+v_10_p)
x_14 = (v_11_p*x_12 + v_12_p * x_11) / (v_11_p+v_12_p)

root = (v_13_p*x_14 + v_14_p * x_13) / (v_13_p+v_14_p)
print(root)'
'''